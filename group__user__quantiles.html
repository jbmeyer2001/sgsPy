<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sgsPy: quantiles</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">sgsPy
   </div>
   <div id="projectbrief">structurally guided sampling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group__user__quantiles.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">quantiles <div class="ingroups"><a class="el" href="group__user.html">User Documentation</a> &raquo; <a class="el" href="group__user__stratify.html">stratify</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga98c2e3dad92ceba628f5788a477c8809" id="r_ga98c2e3dad92ceba628f5788a477c8809"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga98c2e3dad92ceba628f5788a477c8809">sgspy.stratify.quantiles.quantiles.quantiles</a> (<a class="el" href="classsgspy_1_1utils_1_1raster_1_1SpatialRaster.html">SpatialRaster</a> rast, int|list[float]|list[int|list[float]]|dict[str, int|list[float]] num_strata, bool map=False, str filename='', int thread_count=8, dict driver_options=None, float eps=.001)</td></tr>
<tr class="memdesc:ga98c2e3dad92ceba628f5788a477c8809"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function conducts stratification on the raster given by generating quantile probabilities according to the 'num_strata' argument given by the user.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga98c2e3dad92ceba628f5788a477c8809" name="ga98c2e3dad92ceba628f5788a477c8809"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga98c2e3dad92ceba628f5788a477c8809">&#9670;&#160;</a></span>quantiles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sgspy.stratify.quantiles.quantiles.quantiles </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsgspy_1_1utils_1_1raster_1_1SpatialRaster.html">SpatialRaster</a></td>          <td class="paramname"><span class="paramname"><em>rast</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int | list[float] | list[int|list[float]] | dict[str,int|list[float]]</td>          <td class="paramname"><span class="paramname"><em>num_strata</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool </td>          <td class="paramname"><span class="paramname"><em>map</em></span><span class="paramdefsep"> = </span><span class="paramdefval">False</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str </td>          <td class="paramname"><span class="paramname"><em>filename</em></span><span class="paramdefsep"> = </span><span class="paramdefval">''</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int </td>          <td class="paramname"><span class="paramname"><em>thread_count</em></span><span class="paramdefsep"> = </span><span class="paramdefval">8</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dict </td>          <td class="paramname"><span class="paramname"><em>driver_options</em></span><span class="paramdefsep"> = </span><span class="paramdefval">None</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float </td>          <td class="paramname"><span class="paramname"><em>eps</em></span><span class="paramdefsep"> = </span><span class="paramdefval">.001</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function conducts stratification on the raster given by generating quantile probabilities according to the 'num_strata' argument given by the user. </p>
<p>The quantiles may be defined as an integer, indicating the number of quantiles of equal size. Quantiles may also be defined as a list of probabilities between 0 and 1. In the case of a raster with a single band, the quantiles may be passed directly to the num_strata argument as either type: int | list[float].</p>
<p>In the case of a multi-band raster image, the specific bands can be specified by the index of a list containing an equal number of quantiles as bands (list[int | list[float]).</p>
<p>If not all raster bands should be stratified, specific bands can be selected in the form of a dict where the key is the name of a raster band and the value is the quantiles (dict[str, int | list[float]).</p>
<p>if the map parameter is given, an extra output band will be used which combines all stratifications from the bands used into an extra outpu band. A single value in the mapped output band corresponds to a combination a single combination of values from the previous bands.</p>
<p>The thread_count parameter specifies the number of threads which this function will utilize the the case where the raster is large and may not fit in memory. If the full raster can fit in memory and does not need to be processed in blocks, this argument will be ignored. The default is 8 threads, although the optimal number will depend significantly on the hardware being used and may be more or less than 8.</p>
<p>the driver_options parameter is used to specify creation options for the output raster. See options for the Gtiff driver here: <a href="https://gdal.org/en/stable/drivers/raster/gtiff.html#creation-options">https://gdal.org/en/stable/drivers/raster/gtiff.html#creation-options</a> The keys in the driver_options dict must be strings, the values are converted to string. THe options must be valid for the driver corresponding to the filename, and if filename is not given they must be valid for the GTiff format, as that is the format used to store temporary raster files. Note that if this parameter is given, but filename is not and the raster fits entirely in memory, the driver_options parameter will be ignored.</p>
<p>the eps parameter is used only if batch processing is used to calculate the quantiles for a raster. Quantile streaming algorithms cannot be perfectly accurate, as this would necessitate having the entire raster in memory at once. A good approximation can be made, and the error is controlled by this epsilon (eps) value. The Quantile streaming method is the method introduced by Zhang et al. and utilized by MKL: <a href="https://web.cs.ucla.edu/~weiwang/paper/SSDBM07_2.pdf">https://web.cs.ucla.edu/~weiwang/paper/SSDBM07_2.pdf</a> <a href="https://www.intel.com/content/www/us/en/docs/onemkl/developer-reference-summary-statistics-notes/2021-1/computing-quantiles-with-vsl-ss-method-squants-zw.html">https://www.intel.com/content/www/us/en/docs/onemkl/developer-reference-summary-statistics-notes/2021-1/computing-quantiles-with-vsl-ss-method-squants-zw.html</a></p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md36"></a>
Examples</h2>
<p>rast = sgspy.SpatialRaster('rast.tif') <br  />
srast = <a class="el" href="namespacesgspy_1_1stratify_1_1quantiles.html">sgspy.stratify.quantiles</a>(rast, num_strata=5)</p>
<p>rast = sgspy.SpatialRaster('rast.tif') <br  />
srast = <a class="el" href="namespacesgspy_1_1stratify_1_1quantiles.html">sgspy.stratify.quantiles</a>(rast, num_strata=[.1, .2, .3, .5, .7], filename="srast.tif")</p>
<p>rast = sgspy.SpatialRaster('multi_band_rast.tif') <br  />
srast = <a class="el" href="namespacesgspy_1_1stratify_1_1quantiles.html">sgspy.stratify.quantiles</a>(rast, num_strata=[5, 5, [.5, .75]], map=True)</p>
<p>rast = sgspy.SpatialRaster('multi_band_rast.tif') <br  />
srast = <a class="el" href="namespacesgspy_1_1stratify_1_1quantiles.html">sgspy.stratify.quantiles</a>(rast, num_strata={'zq90': 5})</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md37"></a>
Parameters</h2>
<p>rast : <a class="el" href="classsgspy_1_1utils_1_1raster_1_1SpatialRaster.html" title="This class represents a spatial raster, and is used as an input to many sgs functions.">SpatialRaster</a> <br  />
 raster data structure containing the raster to stratify <br  />
 <br  />
num_strata : int | list[float] | list[int|list[float]] | dict[str,int|list[float]] <br  />
 specification of the quantiles to stratify <br  />
 <br  />
map : bool <br  />
 whether to map the stratifiction of multiple raster bands onto a single band <br  />
 <br  />
filename : str <br  />
 filename to write to or '' if no file should be written <br  />
 <br  />
thread_count : int <br  />
 the number of threads to use when multithreading large images <br  />
 <br  />
driver_options : dict[] <br  />
 the creation options as defined by GDAL which will be passed when creating output files <br  />
 <br  />
eps : float <br  />
 the epsilon value, controlling the error of stream-processed quantiles <br  />
 <br  />
 </p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md38"></a>
Returns</h2>
<p>a <a class="el" href="classsgspy_1_1utils_1_1raster_1_1SpatialRaster.html" title="This class represents a spatial raster, and is used as an input to many sgs functions.">SpatialRaster</a> object containing stratified raster bands. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
